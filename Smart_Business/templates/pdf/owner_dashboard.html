<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>{{ business.name }} — Dashboard {{ start }} to {{ end }}</title>
  <style>
    @page { margin: 18mm; }
    body {
      font-family: "DejaVu Sans", "Arial", sans-serif;
      font-size: 12px;
      color: #222;
      margin: 0;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    /* --- Container reserves space at bottom for footer --- */
    .page-content { padding: 18px; padding-bottom: 32mm; /* reserve for footer */ }

    /* Header */
    header { margin-bottom: 6px; }
    .brand {
      width: 100%;
      border-bottom: 1px solid #e6e6e6;
      padding-bottom: 8px;
      margin-bottom: 12px;
    }
    .brand .left { float: left; width: 22%; }
    .brand .center { float: left; width: 56%; text-align:center; }
    .brand .right { float: left; width: 22%; text-align:right; }
    .brand img.logo { max-height: 52px; display:inline-block; }

    /* Big business name + owner */
    h1.business-name {
      font-size: 22px;            /* bigger */
      margin: 2px 0;
      font-weight: 900;
      letter-spacing: -0.5px;
    }
    .owner-name { font-size: 13px; color: #444; margin-top: 2px; }

    .clearfix { clear: both; }

    /* Summary row */
    .summary { width:100%; border-collapse: collapse; margin-bottom: 12px; }
    .summary td { padding: 8px; text-align:center; border: 1px solid #f0f0f0; background: #fafafa; font-size:13px; }
    .summary .label { font-size:11px; color:#666; }
    .summary .value { font-size:15px; font-weight:700; margin-top:4px; }

    /* Data table */
    table.data { width:100%; border-collapse: collapse; margin-top:8px; table-layout: fixed; word-wrap: break-word; }
    table.data thead th { background:#f7f7f7; padding:8px; border:1px solid #eaeaea; font-size:12px; text-align:left; }
    table.data tbody td { padding:8px; border:1px solid #f1f1f1; font-size:12px; vertical-align: middle; }
    table.data tbody tr:nth-child(even) td { background:#fbfbfb; }
    td.col-date { width: 25%; }
    td.col-num { text-align: right; width: 18%; }

    /* footer spacing and separator line */
    .footer-sep { margin-top: 18px; border-top: 1px solid #ddd; }

    tfoot td { font-weight:700; background:#f0f0f0; padding:8px; border:1px solid #e6e6e6; text-align:right; }

    /* Footer fixed at bottom */
    footer {
      position: fixed;
      bottom: 8mm;
      left: 0;
      right: 0;
      text-align: center;
      font-size:10px;
      color:#666;
    }

    /* color profit */
    .profit-positive { color: #1b9e4a; }
    .profit-negative { color: #c0392b; }

    /* ensure no list bullets or markers appear */
    * { -webkit-font-smoothing: antialiased; }
    ul, ol { margin:0; padding:0; list-style:none; }
  </style>
</head>
<body>
  <div class="page-content">
    <header>
      <div class="brand">

        <div class="center">
          <h1 class="business-name">{{ business.name }}</h1>
          <div class="owner-name">Owner: {{ owner_name|default:"—" }}</div>
          <div class="meta" style="font-size:11px; color:#666; margin-top:4px;">
            Dashboard — {{ start }} to {{ end }}
          </div>
        </div>

        <div class="right">
          <div style="font-size:11px; color:#666;">Generated: {{ generated_at }}</div>
        </div>

        <div class="clearfix"></div>
      </div>
    </header>

    <!-- summary -->
    <table class="summary" role="presentation">
      <tr>
        <td>
          <div class="label">Total Sales</div>
          <div class="value">₹ {{ total_sales }}</div>
        </td>
        <td>
          <div class="label">Total Purchases</div>
          <div class="value">₹ {{ total_purchases }}</div>
        </td>
        <td>
          <div class="label">Total Expenses</div>
          <div class="value">₹ {{ total_expenses }}</div>
        </td>
        <td>
          <div class="label">Net Profit</div>
          <div class="value">{% if total_profit|floatformat:2 < 0 %}<span class="profit-negative">₹ {{ total_profit }}</span>{% else %}<span class="profit-positive">₹ {{ total_profit }}</span>{% endif %}</div>
        </td>
      </tr>
    </table>

    <!-- data table -->
    <table class="data" role="table" cellpadding="0" cellspacing="0">
      <thead>
        <tr>
          <th>Date</th>
          <th style="text-align:right">Sales (₹)</th>
          <th style="text-align:right">Purchases (₹)</th>
          <th style="text-align:right">Expenses (₹)</th>
          <th style="text-align:right">Profit (₹)</th>
        </tr>
      </thead>
      <tbody>
        {% for r in rows %}
        <tr>
          <td class="col-date">{{ r.date|date:"M d, Y" }}</td>
          <td class="col-num">₹ {{ r.sales|floatformat:2|stringformat:"s" }}</td>
          <td class="col-num">₹ {{ r.purchases|floatformat:2|stringformat:"s" }}</td>
          <td class="col-num">₹ {{ r.expenses|floatformat:2|stringformat:"s" }}</td>
          <td class="col-num">
            {% if r.profit < 0 %}
              <span class="profit-negative">₹ {{ r.profit|floatformat:2|stringformat:"s" }}</span>
            {% else %}
              <span class="profit-positive">₹ {{ r.profit|floatformat:2|stringformat:"s" }}</span>
            {% endif %}
          </td>
        </tr>
        {% empty %}
        <tr><td colspan="5" style="text-align:center; padding:18px;">No records for this period.</td></tr>
        {% endfor %}
      </tbody>
      <tfoot>
        <tr>
          <td style="text-align:left">Totals</td>
          <td>₹ {{ total_sales }}</td>
          <td>₹ {{ total_purchases }}</td>
          <td>₹ {{ total_expenses }}</td>
          <td>
            {% if r.total_profit < 0 %}
              <span class="profit-negative">₹ {{ total_profit }}</span>
            {% else %}
              <span class="profit-positive">₹ {{ total_profit }}</span>
            {% endif %}
          </td>
        </tr>
      </tfoot>
    </table>

    <!-- horizontal separator just above footer -->
    <div class="footer-sep" aria-hidden="true"></div>
  </div> <!-- /.page-content -->

  <footer>
    <div>Prepared by {{ business.name }} • Generated: {{ generated_at }}</div>
    <div>Page <pdf:pagenumber /> of <pdf:pagecount /></div>
  </footer>
</body>
</html>
